<% actionable ||= purchase.user == current_user %>
<% show_want ||= false %>
<div id="purchase-<%= purchase.id %>" class="panel panel-default">
  <div class="panel-body">
    <% if actionable %>
      <% if purchase.want.present? %>
        <%= render purchase.want.wanted, plain: true if show_want %>
        You purchased this for 
        <%= link_to purchase.want.user.name, purchase.want.user %>
        on <%= local_time(purchase.updated_at) %>
        <p><%= purchase.comment %></p>
        <%= link_to 'I have given this item', give_want_purchase_path(purchase.want, purchase),
            method: :post, remote: true %>
      <% else %>
        Uh oh, it looks like the person you purchased something for on
        <%= local_time(purchase.updated_at) %> 
        has removed the item from their list!
        <p><%= purchase.comment %></p>
      <% end %>
    <% else %>
      Someone purchased this for
      <%= purchase.want.user.name %> on
      <%= local_time(purchase.updated_at) %>
      <p><%= purchase.comment %></p>
    <% end %>
  </div>
</div>